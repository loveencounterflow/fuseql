{"version":3,"sources":["main.coffee"],"names":[],"mappings":"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","file":"main.js","sourceRoot":"/source/","sourcesContent":["\n\n\n\n############################################################################################################\nnjs_path                  = require 'path'\n# njs_fs                    = require 'fs'\n#...........................................................................................................\nCND                       = require 'cnd'\nrpr                       = CND.rpr.bind CND\nbadge                     = 'FUSEQL/main'\nlog                       = CND.get_logger 'plain',   badge\ninfo                      = CND.get_logger 'info',    badge\nalert                     = CND.get_logger 'alert',   badge\ndebug                     = CND.get_logger 'debug',   badge\nwarn                      = CND.get_logger 'warn',    badge\nurge                      = CND.get_logger 'urge',    badge\nwhisper                   = CND.get_logger 'whisper', badge\nhelp                      = CND.get_logger 'help',    badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\nsuspend                   = require 'coffeenode-suspend'\nstep                      = suspend.step\n# immediately               = suspend.immediately\n# after                     = suspend.after\n# sleep                     = suspend.sleep\n# later                     = setImmediate\n\nlevelup                   = require 'levelup'\nlevelfs                   = require 'level-filesystem'\nadd_writestream           = require 'level-writestream'\n\n#-----------------------------------------------------------------------------------------------------------\ndump = ( db, handler ) ->\n  D             = require 'pipedreams'\n  input = db.createReadStream()\n  input\n    .pipe D.$show()\n    .pipe D.$on_end ->\n      handler() if handler?\n\n#-----------------------------------------------------------------------------------------------------------\n@new_db = ( format, route ) ->\n  #.........................................................................................................\n  switch format\n    when 'level'  then backend = require 'leveldown'\n    when 'json'   then backend = require 'jsondown'\n    when 'memory' then backend = require 'memdown'\n    when 'sqlite' then backend = require 'sqldown'\n    else throw new Error \"unknown DB format #{rpr format}\"\n  #.........................................................................................................\n  # db_route      = njs_path.join __dirname, \"db.#{extension ? format}\"\n  return add_writestream levelup route, db: backend\n\n#-----------------------------------------------------------------------------------------------------------\n@_demo = ->\n  step ( resume ) =>\n    # db        = @new_db 'json', '/tmp/foo.json'\n    db        = @new_db 'sqlite', '/tmp/foo.db'\n    xfs       = levelfs db\n    settings  =\n      encoding: 'utf-8'\n    yield xfs.mkdir '/even', resume\n    yield xfs.mkdir '/odd',  resume\n    for idx in [ 0 .. 10 ]\n      route = \"hello-world-#{idx}.txt\"\n      route = if ( idx % 2 is 0 ) then \"/even/#{route}\" else \"/odd/#{route}\"\n      data  = \"foo #{idx} bar #{idx} baz #{idx}\"\n      yield xfs.writeFile route, data, settings, resume\n    names = yield xfs.readdir '/even/', resume\n    help names\n    for name in names\n      route = \"/even/#{name}\"\n      stat  = yield xfs.stat route, resumeÂ \n      help route, stat.isFile(), stat.isDirectory()\n\n############################################################################################################\nunless module.parent?\n  @_demo()\n\n\n\n\n\n"]}