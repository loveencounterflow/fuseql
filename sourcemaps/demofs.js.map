{"version":3,"sources":["demofs.coffee"],"names":[],"mappings":"AAIA;AAAA,MAAA;;EAAA,MAAA,GAGE;IAAA,OAAA,EAAS,SAAE,KAAF,EAAS,OAAT;AACP,UAAA;MAAA,IAAA,CAAK,aAAL,EAAoB,KAApB;MACA,IAAG,KAAA,KAAS,GAAZ;QACE,SAAA;;AAAc;eAAyB,+BAAzB;yBAAA,OAAA,GAAQ;AAAR;;;QACd,SAAS,CAAC,IAAV,CAAe,MAAf;AACA,eAAO,OAAA,CAAQ,IAAR,EAAc,SAAd,EAHT;;MAIA,OAAA,CAAQ,IAAR;IANO,CAAT;IAUA,OAAA,EAAS,SAAC,KAAD,EAAQ,OAAR;MACP,IAAA,CAAK,aAAL,EAAoB,KAApB;AACA,cAAO,KAAP;AAAA,aACO,GADP;UAEI,OAAA,CAAQ,CAAR,EACE;YAAA,KAAA,EAAO,IAAI,IAAX;YACA,KAAA,EAAO,IAAI,IADX;YAEA,KAAA,EAAO,IAAI,IAFX;YAGA,IAAA,EAAM,GAHN;YAIA,IAAA,EAAM,KAJN;YAKA,GAAA,EAAK,OAAO,CAAC,MAAR,CAAA,CALL;YAMA,GAAA,EAAK,OAAO,CAAC,MAAR,CAAA,CANL;WADF;AADG;AADP,aAUO,OAVP;UAWI,OAAA,CAAQ,CAAR,EACE;YAAA,KAAA,EAAO,IAAI,IAAX;YACA,KAAA,EAAO,IAAI,IADX;YAEA,KAAA,EAAO,IAAI,IAFX;YAGA,IAAA,EAAM,EAHN;YAIA,IAAA,EAAM,KAJN;YAKA,GAAA,EAAK,OAAO,CAAC,MAAR,CAAA,CALL;YAMA,GAAA,EAAK,OAAO,CAAC,MAAR,CAAA,CANL;WADF;AADG;AAVP;UAoBI,OAAA,CAAQ,CAAR,EACE;YAAA,KAAA,EAAO,IAAI,IAAX;YACA,KAAA,EAAO,IAAI,IADX;YAEA,KAAA,EAAO,IAAI,IAFX;YAGA,IAAA,EAAM,IAHN;YAIA,IAAA,EAAM,KAJN;YAKA,GAAA,EAAK,OAAO,CAAC,MAAR,CAAA,CALL;YAMA,GAAA,EAAK,OAAO,CAAC,MAAR,CAAA,CANL;WADF;AApBJ;AA8BA,aAAO;IAhCA,CAVT;IA6CA,IAAA,EAAM,SAAC,KAAD,EAAQ,KAAR,EAAe,OAAf;MACJ,IAAA,CAAK,cAAL,EAAqB,KAArB,EAA4B,KAA5B;MACA,OAAA,CAAQ,CAAR,EAAW,EAAX;IAFI,CA7CN;IAoDA,IAAA,EAAM,SAAE,KAAF,EAAS,EAAT,EAAa,GAAb,EAAkB,GAAlB,EAAuB,GAAvB,EAA4B,OAA5B;AACJ,UAAA;MAAA,IAAA,CAAK,sBAAL,EAA6B,KAA7B,EAAoC,EAApC,EAAwC,GAAxC,EAA6C,GAA7C;MACA,cAAA,GAAkB;MAClB,IAAqC,cAAgB,CAAA,CAAA,CAAhB,KAAuB,GAA5D;QAAA,cAAA,GAAkB,GAAA,GAAI,MAAtB;;MACA,IAAqC,cAAgB,CAAA,CAAA,CAAhB,KAAuB,GAA5D;QAAA,cAAA,GAAkB,GAAA,GAAI,MAAtB;;MACA,OAAA,GAAkB,QAAQ,CAAC,OAAT,CAAiB,aAAjB,EAAgC,cAAhC;MAClB,IAAA,CAAK,QAAL,EAAe,cAAf;MACA,IAAA,CAAK,QAAL,EAAe,aAAf;MACA,IAAA,CAAK,QAAL,EAAe,OAAf;MACA,OAAA,GAAU,oBAAA,GAED,OAFC,GAEO;MAEjB,OAAA,GAAU,OAAO,CAAC,KAAR,CAAc,GAAd;MACV,IAAG,CAAC,OAAJ;AACE,eAAO,OAAA,CAAQ,CAAR,EADT;;MAEA,GAAG,CAAC,KAAJ,CAAU,OAAV;aACA,OAAA,CAAQ,OAAO,CAAC,MAAhB;IAjBI,CApDN;;AAHF","file":"demofs.js","sourceRoot":"/source/","sourcesContent":["\n\n\n#-----------------------------------------------------------------------------------------------------------\ndemofs =\n\n  #---------------------------------------------------------------------------------------------------------\n  readdir: ( route, handler ) ->\n    echo 'readdir(%s)', route\n    if route == '/'\n      filenames = ( \"file-#{idx}\" for idx in [ 0 .. 10 ] )\n      filenames.push 'test'\n      return handler null, filenames\n    handler null\n    return\n\n  #---------------------------------------------------------------------------------------------------------\n  getattr: (route, handler) ->\n    info 'getattr(%s)', route\n    switch route\n      when '/'\n        handler 0,\n          mtime: new Date\n          atime: new Date\n          ctime: new Date\n          size: 100\n          mode: 16877\n          uid: process.getuid()\n          gid: process.getgid()\n      when '/test'\n        handler 0,\n          mtime: new Date\n          atime: new Date\n          ctime: new Date\n          size: 12\n          mode: 33188\n          uid: process.getuid()\n          gid: process.getgid()\n      else\n        handler 0,\n          mtime: new Date\n          atime: new Date\n          ctime: new Date\n          size: 1234\n          mode: 33188\n          uid: process.getuid()\n          gid: process.getgid()\n      # else\n      #   handler FUSE.ENOENT\n    return null\n\n  #---------------------------------------------------------------------------------------------------------\n  open: (route, flags, handler) ->\n    info 'open(%s, %d)', route, flags\n    handler 0, 42\n    # 42 is an fd\n    return\n\n  #---------------------------------------------------------------------------------------------------------\n  read: ( route, fd, buf, len, pos, handler ) ->\n    info 'read(%s, %d, %d, %d)', route, fd, len, pos\n    relative_route  = route\n    relative_route  = \"/#{route}\" unless relative_route[ 0 ] is '/'\n    relative_route  = \".#{route}\" unless relative_route[ 0 ] is '.'\n    locator         = njs_path.resolve mount_locator, relative_route\n    info '©jQFeh', relative_route\n    info '©Qpb1T', mount_locator\n    info '©zZVe3', locator\n    content = \"\"\"\n      hello world\n      from #{locator}\n      \\n\"\"\"\n    content = content.slice(pos)\n    if !content\n      return handler(0)\n    buf.write content\n    handler content.length\n"]}